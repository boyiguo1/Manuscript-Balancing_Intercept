The original proposal [@rudolph2021] of the balance intercept defaults to the reference coding system without explicit mentioning, and carries along in the subsequent studies. The intercept term in the reference coding scheme describes the conditional probability of the reference level of a categorical variable. Forcing the intercept term to the target marginal probability (referred to as the standard intercept in @rudolph2021) would naturally fail due to the definition discrepancy. Statistically, to derive the balance intercept is to derive the conditional probability of the reference level and can be achieved with analytic and numeric approximations. Nevertheless, the accuracy could be vulnerable to the quality of numeric analysis and programming efficiency. To note, the balance intercept in data generating models always exists and is unique as the model degree of freedom is fixed.

In many scenarios, the balance intercept is analytically tractable with extra cautious. As previously discovered in @robertson2021, the analytic approximation fails because of the inequality between a function of the expectation and the expectation of a function when the function is not linear. For example, when the link function is logistic function, the expectation of log odds, $E(logit(Y))$, does not equal to the log odds of the expectation $logit(E(Y))$. Hence, anchoring the calculation in the response scale is preferred in comparison to the linear predictor scale which @rudolph2021 employs. Suppose the marginal probability $\pi$, the estimand ratio (e.g. risk ratio, odds ratio) against the reference level for the $i$th level, $\beta_{i-1}$, and the sample size for the $i$th level $n_i$ is given,  the marginal probability can be formulated as the weighted summation of the conditional probabilities $\pi_i$
$$
  \pi = \sum\limits^p_{i=1}\frac{n_i}{n}\pi_i,\text{ where }n = \sum\limits^{p}_{i=1}n_i.
$$
In order to for the reference level, we need to write each conditional probability as a function of the reference level probability. The solution is tractable when link function is log function, $\pi_1 = \frac{n\pi}{n_1 + \sum\limits^p_{i=2}n_i\exp(\beta_{i-1})}$, and identify function, $\pi_1 = \pi-\sum\limits^p_{i=2}\frac{n_i}{n}\beta_{i-1}$. [TODO: provide the full-on derivations in the supporting information ] When the link function becomes more complex, e.g., logistic function, the solution is not algebraically tractable. The closed form equations provides computational convenience when link function is the identify function or log function. [TODO: write a generalizes]

<!-- following $\pi_j = g^{-1}(g(\pi_1)+\beta_{j-1})$ on multiplicative scale and $\pi_j = g^{-1}(g(\pi_1)+\beta_{j-1})$ on additive scale where $g$ is the link function. -->

Using the reference coding system in data generating models is very convenient when the comparison between the group means are the known information. Nevertheless, it requires additional calculation when conditional probabilities are given. In this case, it is more convenient to use effect coding system, where the coefficients describe the discrepancy of the level means. Meanwhile, the intercept term in the effect coding scheme describes the mean of the group means, which coincides with the marginal probability when the sample sizes are balanced across levels. In other words, the balance intercept problem does not exist for simulations with balanced designs when using the effect coding. When the underlying design is not balanced, the intercept is simply to calculate the grand mean by averaging the conditional probabilities, $\delta_0 = \sum\limits_{j=1}^p \pi_j /p$.
