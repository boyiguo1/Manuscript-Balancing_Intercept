---
bibliography: references.bib
---

As the field of epidemiology evolves, there are growing interests to employ more computational approaches to solve analytic problems. Among them, simulation is one of the most accessible concepts. Previous literature argues the importance of simulation in epidemiology education and research. [TODO: add citations] In this commentary, we review a series of discussion on the balance intercept problem published on previous issues of American Journal of Epidemiology [TODO: add citations]. Specifically, we explain the balance intercept problem from a statistical perspective and derive a closed-form solution for some commonly used data generating mechanisms. In addition, we provide some tips and tricks to simply the simulation process.

The balance intercept problem was first introduced by @rudolph2021. The objective is to control the marginal means of simulated outcomes at a desired level when limited information is presented. To start with a simple example, we are interested in simulating normally distributed outcomes for two groups of samples, in other words a binary exposure, with fixed group sizes. In an idea scenario where the corresponding group (conditional) means are known, we can simply sample the outcomes for each group using these group means and aggregate the simulated data to form the overall dataset. Nevertheless, this approach fails if we only know the marginal mean and the mean difference, which retains the same amount of statistical information. This is because the model degree of freedom is fixed. The process of deriving the conditional means based on marginal mean and the mean differences is the balance intercept problem. Specifically, the balance intercept is the conditional mean of the reference group/group when the categorical covariates are enumerate using the reference coding system. The closed-form equation in @rudolph2021 can be used to calculate the balance intercept in this toy example.

[TODO: insert the equation here]

Most simulation designs are more complex than the two-sample normal outcomes design, for example the consideration of estimands and outcomes, covariate adjustment and graphical causal model, and multiple-level exposures. Hence, calculating the balance intercept is more complicated and requires further discussion in the following paragraphs. 

To generalize the balance intercept problem to other outcomes and estimands, we need to first review a simple statistics concept, the link function. Similar to the generalized linear model, we need a link function to describe the mathematical relationship between linear predictors and the mean of a outcome in the simulation design. For example, we can simulate Gaussian outcomes with a log function (link function) to study the mean ratio (estimand) or a binary outcome with a logit function to study the odds ratio. When calculating the balance intercept, the choice of the link function in the simulation design dominates the complexity of the calculation. For example, when a nonlinear link function is used, the closed-form equation in @rudolph2021 becomes an approximation of balance intercept and fails to control the marginal mean with accuracy, due to the inequality between the expectation of a link function and the link function of an expectation. [TODO: add math notation] Meanwhile, the choice of link functions limits if a closed-form equation of the balance intercept is possible. We derive the the closed-form equation for linear link function and log link function in the appendix. The balance intercept is mathematically intractable with logit link function, and hence, we recommand to use numeric approximation proposed by @robertson2021 and @zivich2022.


<!-- To better understand the balance intercept problem, we first review two basic statistics concepts, coding schemes and link functions. A coding scheme describes how a categorical variable is enumerated in a regression system. Most commonly used coding schemes include the reference coding (also known as dummy coding) and the effect coding. Both coding schemes create $p-1$ columns for a categorical variable with $p$ levels. The reference coding employs 0 and 1 to denote the level an individual belongs, while the effect coding employs 0, 1, and -1. For example, a binary variable would be coded as a vector of 0 for the reference level and 1 for the comparing level using the reference coding and a vector of 1 and -1 using the effect coding. (See an example of three-level categorical variable in Table 1). As the enumerations are different for the two coding schemes, they offer different interpretations of regression coefficients. The reference coding emphasizes the change relative to a reference level of preference; the effect coding emphasizes the deviation from the grand mean (here refer to as the mean of the level means). Nevertheless, the two schemes translate to each other one-on-one and provide the same statistical inference. To note, both coding schemes can be applied ubiquitously in any regression system regardless the outcome distribution and the link function of choice.  -->

<!-- For more techinical details, we defer to [TODO: add textbook, probably INTRODUCING ANOVA and ANCOVA by andrew rutherford]. -->

<!-- \input{tab/code_scheme.tex} -->


